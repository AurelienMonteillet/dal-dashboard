# Tezos DAL-o-meter Dashboard

This dashboard allows real-time visualization of the adoption statistics of the DAL (Data Availability Layer) protocol on the Tezos network.

## Project Structure

The project has been optimized with a clean separation of concerns:

```
/opt/dal_dashboard/
├── backend/              # Backend components
│   ├── scripts/          # Python scripts for data collection
│   │   ├── dal_calculation.py    # Main calculation script
│   │   └── update_dal_stats.sh   # Update script with Git integration
│   ├── data/             # Data files generated by the scripts
│   │   ├── dal_stats.json
│   │   └── dal_stats_history.json
│   └── requirements.txt  # Python dependencies
├── frontend/             # Next.js frontend application
│   ├── app/              # App router components
│   ├── public/           # Contains symlinks to the actual data
│   └── ...
├── logs/                 # Log files
└── crontab_setup.sh      # Script to set up automated updates
```

## How It Works

1. **Data Collection**: 
   - The `dal_calculation.py` script collects data from Tezos blockchain using TzKT API
   - It analyzes baker participation in the DAL protocol
   - Results are stored in JSON files in the `backend/data/` directory

2. **Data Presentation**:
   - The Next.js frontend reads data using symbolic links in the `public/` folder
   - It displays statistics using gauge charts and tables

3. **Automation**:
   - A cron job runs every 2 days to update the statistics
   - The `update_dal_stats.sh` script handles running the calculation and Git commits

## Setup Instructions

### Backend Setup

1. Install Python dependencies:
   ```bash
   cd /opt/dal_dashboard
   pip install -r backend/requirements.txt
   ```

2. Set up the cron job:
   ```bash
   ./crontab_setup.sh
   ```

### Frontend Setup

1. Install Node.js dependencies:
   ```bash
   cd /opt/dal_dashboard/frontend
   npm install
   ```

2. Run the development server:
   ```bash
   npm run dev
   ```

3. Build for production:
   ```bash
   npm run build
   ```

## API Endpoints

The dashboard provides several API endpoints:

- `/api/stats` - Current DAL statistics
- `/api/history` - History of DAL statistics by cycle
- `/api/cycle/[cycle]` - Data for a specific cycle

## Manual Data Updates

To manually update the statistics:

```bash
cd /opt/dal_dashboard
./backend/scripts/update_dal_stats.sh
```

## Logs

All logs are stored in the `/opt/dal_dashboard/logs/` directory:
- `dal_update.log` - Update script logs
- `dal_stats.log` - Calculation script logs
